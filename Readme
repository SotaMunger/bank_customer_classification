This end-to-end data science project compares the performance of three ensemble classification models that predict bank customers' employment sectors (public, private, or unemployed) using their demographic data and credit card spending habits. The three models tested here include a bagging classifier, an Adaboost classifier, and a gradient boost classifier (all imported from the sklearn.ensemble class).  All three models use decision trees as their base algorithms.

The steps in the project workflow (explained in more detail below) include:

1. Data cleaning and feature engineering
2. Exploratory data analysis
3. Data processing
4. Dimensionality reduction
5. Hyperparameter tuning
6. Training
7. Testing

The data set used in this analysis is proprietary and cannot be shared in this repository.

<b>Data cleaning and feature engineering<b\>

After dropping geographical coordinate features for branch, home, and work locations (which were redundant with branch, home, and work region features), the demographic data set consisted of the following features:

Cust_segment - the type of account the customer held
Branch_ID - the bank branch number where the customer opened the account
Gender (binary)
Marital_Status (see categories in the translation section below)
Education_lv (see categories in the translation section below)
Job_Status - employment categories (grouped as private, public, and unemployed for this analysis)
Income - annual earnings
Age
Years_w_Bank
Penalty_ (12 columns) - Credit card payment delinquincy status for each month from July 2014 to June 2015
Work_Region - geographical region of the customer's workplace
Home_Region - geographical region of the customer's home
Branch_Region - geographical region of the customer's primary bank branch

The data types are found in the df.info() output below:

file:///home/richard/Pictures/Screenshots/Screenshot%20from%202023-04-26%2020-07-22.png

The penalty columns for each month were first converted to columns consisting of counts for each category i.e. one column for RISKSIZ (Good Standing), one column for GECIKME 1-15 GUN (Late 1-15 days), etc. with counts for the number of times the customer held that status through the 12 month period.  Then, the Job_Status categories were grouped accordingly:

employment categories

The other categories were later dropped because they did not fit neatly into one of the three label groups. After regrouping, the three label categories had the following value counts:

employment value counts

Next, the credit card transaction data set, which consisted of 9,335,625 unique transactions and features customer ID (Cust_ID), spending category (Category), and transaction amount (Trans_Amt) collected for each transaction, was re-engineered.  Transactions were grouped by customer ID and spending category and aggregated by the sum of the transaction amount.  A pivot table was then created that displayed the amount each customer ID (rows) spent in each category (columns).  There were 25 spending categories in all (see the Spending Categories translation section below for the full list).  The transaction pivot table was then joined to the demographic data set by customer ID.

<b>Exploratory Data Analysis<b\>

The data set was first checked for null values.  Oddly, there were 1345 customers that had null values for all credit card spending categories and were categorized in the 'DİĞER' (Other) employment category.  This finding gave further reason to drop 'DİĞER' customers from the data set.  Furthermore, there were only four customers that had null values in the Home_Region column and four customers that had null values in the Branch_Region column so these customers were likewise dropped.

Histograms created for each of the spending categories revealed that, in every category, a great majority of customers spent very little but at least a few customers spent a great deal.

<b>Data Processing<\b>
The data set was split into training and test sets at a 80/20 ratio using the StratifiedShuffleSplit class, which preserves the ratio of the employment categories in the training and test sets.  The 'Job_Status' column was split off from the data set and treated as the label.

A data processing pipeline was then built which included a SimpleImputer to fill in any remaining null values with the median value of the column, a StandardScaler to standardize all numerical values (so that each entry in a column was converted to a z-score, and a OneHotEncoder to convert categorical values into a sparse matrix.  The training set was then processed through the pipeline.

<b>Dimensionality Reduction<\b>

Truncated singular value decomposition (TruncatedSVD from the sklearn.decomposition class) was then used to reduce the column count to only those that contained a great deal of variability.  Of the original 86 components, 46 were deemed unimportant for prediction.  Those 46 columns were then dropped from the training set.

<b>Hyperparameter Tuning<\b>

Hyperparameter tuning (not shown in the code) was performed on a small portion of the training set in a separate notebook because tuning on the entire training set exhausted compute resources. RandomizedSearchCV, from the sklearn.model_selection class, which chooses randomly from a range of hyperparameter values was used to perform the tuning operation for each ensemble model.  Depending on the classifier model, such hyperparameters as number of estimators, learning rate, decision tree depth were optimized.

<b>Training<\b>

Each model was then trained on the entire training set, using the hyperparameter settings determined in the previous step.

<b>Testing<\b>

The test sets were then run through the data processing pipeline and tested in each ensemble model. Performance was even across the board, with all models scoring 88% in accuracy.  The bagging classifier, however, was much less likely to predict that customers were public sector employees or unemployed, and instead favored the private sector category.  Both gradient boost and Adabost were much more likely to predict that customers worked in the public sector or were unemployed.


Because the bank that shared its dataset is headquartered and operates in Turkey, some feature headings (demographic designations) and feature categories are written in Turkish.  Translations (Derived partly from Google Translate) for those headings and categories are as follows:

Customer Segment Categories:
BIREYSEL - Individual
BIREBIR - One to One
MİKRO - Micro
EXI26 - Exi26
ÖZEL BANKACILIK MÜŞTERİLERİ - Private Banking

Marital Status Categories:
EVLI - Married
BILINMIYOR - Unknown
BEKAR - Single
DUL - Widowed
BOSANMIS - Divorced

Education Level Categories:	
LISE - High school
ORTAOKUL - Elementary
UNIVERSITE - University
ILKOKUL - Primary school
BILINMIYOR - Unknown
LISASUSTU - Graduate school
YUKSEKOKUL - College (Junior)

Delinquency Status Headings:
RISKSIZ - Good standing
GECIKME 1-15 GUN - Late 1-15 days
GECIKME 16-29 GUN - Late 16-29 days
GECIKME 30-59 GUN - Late 30-59 days
GECIKME 60+ GUN - Late 60+ days
TAKIP - Referred to collection agency

Spending Categories:
SAGLIK - Health
NAKİT AVANS	- Cash Advance
DİĞER	- Other
RESTORAN	- Restaurant
TEKSTİL	- Textile
AYAKKABI	- Shoes
TEKNOLOJİ	- Technology
SİGORTA-MAIL ORDER - Insurance-Mail Order
BEYAZ EŞYA - Household Appliances
HİZMET SEKTÖRLERİ	- Service Sector
HAVAYOLLARI	- Airlines
ALIŞVERİŞ MERKEZLERİ - Shopping Malls
AKARYAKIT - Liquid Fuel
KUYUMCU - Jewelry
MUZIK MARKET KIRTASİYE - Music Market Stationery
MOBİLYA, DEKORASYON - Furniture, Decoration
KOZMETİK - Cosmetics
YAPI MALZ., HIRDAVAT, NALBURİYE - Building Materials, Hardware, Hardware
SPOR GİYİM - Sportswear
OPTİK - Optical
İÇKİLİ YERLER, KUMARHANE - Bars, Casinos
SİNEMA TİYATRO SANAT - Cinema, Theater, Art
ARABA KİRALAMA - Car Rental
HOTEL - Hotels
SİGORTA - Insurance
OTOMOTİV - Automotive
EĞİTİM - Education
EĞLENCE VE SPOR - Entertainment And Sports
OYUNCAK - Toys
MOTOSİKLET - Motorcycle
DOĞRUDAN PAZARLAMA-MAIL ORDER - Direct Marketing-Mail Order
